// this is autogenerated file, do not edit manually!
#include "m_pd.h"
#ifndef __ui_circular_meter_tcl_h
#define __ui_circular_meter_tcl_h
namespace {
void ui_circular_meter_tcl_output() {
	sys_vgui("%s", "namespace eval ui {\nnamespace eval cm {\nvariable FS 39.0\nvariable LED_PAD 3.0\nvariable PEAK_PAD 1.0\nvariable CHAN_CIRCLE 8.0\nvariable FONT\nswitch -- [tk::windowingsystem] {\n\"aqua\" { set FONT {Monaco 8} }\n\"win32\" { set FONT {DejaVuSansMono 8} }\ndefault { set FONT {Monaco 8} }\n}\nproc mmeter_db2color { db cold tepid warm hot over } {\nif {$db < -30} { return $cold }\nif {$db < -21} { return $tepid }\nif {$db < -12} { return $warm }\nif {$db < -3 } { return $hot } { return $over }\n}\nproc draw_pie {cnv w h tag n db led_size a0 a1 color} {\nif { $db > $n } {\nset pie [expr $led_size*min($n+1, $db)]\nset x0 [expr ($w-$pie)/2]\nset y0 [expr ($h-$pie)/2]\nset x1 [expr $x0 + $pie]\nset y1 [expr $y0 + $pie]\n$cnv create arc $x0 $y0 $x1 $y1 -fill $color -outline $color -width 0 -start $a0 -extent $a1 -tags $tag\n}\n}\nproc create_crms { id cnv w h cold tepid warm hot over nch offset cw angles data } {\nvariable FS\nvariable LED_PAD\nvariable CHAN_CIRCLE\nvariable FONT\nset pi2 6.283185307179586\nset half_pi 1.57079632");
	sys_vgui("%s", "67948966\nset rad 0.017453292519943295\nset t [::ceammc::ui::widget_tag $id]\nset area_ht [expr $w-(4*$LED_PAD)]\nset led_len [expr $area_ht/5.0]\nset radius [expr $area_ht/2]\nset seg_off_deg [expr abs(([lindex $angles 1]-[lindex $angles 0])/2)]\nset seg_off_rad [expr $seg_off_deg*$rad]\nset cx [expr $w/2]\nset cy [expr $h/2]\nfor {set ch 0} {$ch < $nch} {incr ch} {\nset rms [lindex $data [expr $ch*2]]\nif {$rms <= -$FS} { continue }\nset idx [expr ($ch-$offset)%$nch]\nset angle [expr [lindex $angles $idx]]\nif {[expr $idx+1]<$nch} { set a1 [lindex $angles [expr $idx+1]] } { set a1 360 }\nset segm [expr $a1-$angle]\nset led_db [expr ($FS+$rms)/9.0]\nset a [expr $angle-$seg_off_deg+90]\ndraw_pie $cnv $w $h $t 4 $led_db $led_len $a $segm $over\ndraw_pie $cnv $w $h $t 3 $led_db $led_len $a $segm $hot\ndraw_pie $cnv $w $h $t 2 $led_db $led_len $a $segm $warm\ndraw_pie $cnv $w $h $t 1 $led_db $led_len $a $segm $tepid\ndraw_pie $cnv $w $h $t 0 $led_db $led_len $a $segm $cold\nset peak [lindex $data [expr $ch*2+1]]\ni");
	sys_vgui("%s", "f {$peak < -$FS} { continue }\nset c [mmeter_db2color $peak $cold $tepid $warm $hot $over]\nset led_db [expr ($FS+$peak)/9.0]\nset pie [expr $led_len*$led_db]\nset x0 [expr ($w-$pie)/2]\nset y0 [expr ($h-$pie)/2]\nset x1 [expr $x0 + $pie]\nset y1 [expr $y0 + $pie]\n$cnv create arc $x0 $y0 $x1 $y1 -style arc -outline $c -width 3 -start $a -extent $segm -tags $t\n}\nfor {set i 1} {$i <= 5} {incr i} {\nset led [expr $led_len*$i]\nset x0 [expr ($w-$led)/2]\nset y0 [expr ($h-$led)/2]\nset x1 [expr $x0 + $led]\nset y1 [expr $y0 + $led]\n$cnv create oval $x0 $y0 $x1 $y1 -outline gray -width 1 -tags $t\n}\nfor {set ch 0} {$ch < $nch} {incr ch} { \nset idx [expr ($ch-$offset)%$nch]\nset angle [expr [lindex $angles $idx]*$rad]\nif {[expr $idx+1]<$nch} { set a1 [expr [lindex $angles [expr $idx+1]]*$rad] } { set a1 $pi2 }\nset segm [expr $a1-$angle]\nset a [expr $angle-$seg_off_rad+$half_pi]\nset x1 [expr $cx+$radius*cos($a)]\nset y1 [expr $cy-$radius*sin($a)]\n$cnv create line $cx $cy $x1 $y1 -fill gray -width 3 -tags $t\nse");
	sys_vgui("%s", "t x1 [expr $cx+$radius*cos($a+$segm/2)]\nset y1 [expr $cy-$radius*sin($a+$segm/2)]\n$cnv create oval [expr $x1-$CHAN_CIRCLE] [expr $y1-$CHAN_CIRCLE] [expr $x1+$CHAN_CIRCLE] [expr $y1+$CHAN_CIRCLE] \\\n-fill darkgray -width 0 -tags $t\nif {$cw} { set txt [expr ($nch-$ch)%$nch+1] } { set txt [expr ($ch)%$nch+1] }\n$cnv create text $x1 $y1 -text $txt -width 20 -justify center -anchor center -fill white -font $FONT -tags $t\n}\n}\nproc delete {id cnv} {\nset t [::ceammc::ui::widget_tag $id]\n$cnv delete $t\n}\nproc create {id cnv w h bdcolor cold tepid warm hot over nch offset cw angles data} {\ncreate_crms $id $cnv $w $h $cold $tepid $warm $hot $over $nch $offset $cw $angles $data\n}\n}\n}\nif {[info exists ::env(TEST_PD_TCL)]} {\nnamespace eval ceammc {\nnamespace eval ui {\nproc widget_tag {id} { return \"tag_$id\" }\n}\n}\nwm title . \"ui.cm~ test\"\nwm geometry . 840x450\nset c0 [tk::canvas .canvas0 -width 200 -height 200 -background white]\nui::cm::create id $c0 200 200 grey green yellow orange red black 5 0 0 [list ");
	sys_vgui("%s", "0 72 144 180 270] [list -3 0 -12 -10 -21 -15 -31 -25 0 3]\nset c1 [tk::canvas .canvas1 -width 200 -height 200 -background white]\nui::cm::create id $c1 200 200 grey green yellow orange red black 5 -1 0 [list 0 72 144 180 270] [list -3 0 -12 -10 -21 -15 -31 -25 0 3]\nset c2 [tk::canvas .canvas2 -width 200 -height 200 -background white]\nui::cm::create id $c2 200 200 grey green yellow orange red black 5 0 1 [list 0 72 144 180 270] [list -3 0 -12 -10 -21 -15 -31 -25 0 3]\nset c3 [tk::canvas .canvas3 -width 200 -height 200 -background white]\nui::cm::create id $c3 200 200 grey green yellow orange red black 5 1 1 [list 0 72 144 180 270] [list -3 1 -12 -10 -21 -15 -31 -25 0 3]\npack $c0 $c1 -side left\npack $c2 $c3 -side left\n}\n");
}
}
#endif // __ui_circular_meter_tcl_h
