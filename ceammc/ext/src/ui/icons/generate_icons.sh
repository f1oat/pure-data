#!/bin/bash

ICONS=$(ls ic_*24dp.png | cut -d_ -f2- | sed 's/_black_24dp\.png//' | sort)
SUFFIX0="_black_18dp.png"
SUFFIX1="_black_24dp.png"
SUFFIX2="_black_36dp.png"
SUFFIX3="_black_48dp.png"
ALL_ICONS=""


cat <<EOF
// this file is autogenerated, do not edit manually!
#ifndef GENERATED_ICONS_H
#define GENERATED_ICONS_H

#include "m_pd.h"
EOF

for i in $ICONS;
do
    f="ic_${i}${SUFFIX1}"
    echo "const char* icon_${i}_18 = \"$(cat ic_${i}${SUFFIX0} | base64)\";"
    echo "const char* icon_${i}_24 = \"$(cat ic_${i}${SUFFIX1} | base64)\";"
    echo "const char* icon_${i}_36 = \"$(cat ic_${i}${SUFFIX2} | base64)\";"
    echo "const char* icon_${i}_48 = \"$(cat ic_${i}${SUFFIX3} | base64)\";"
    echo ""
    ALL_ICONS="$i ${ALL_ICONS}"
done

# add ceammc logo
ALL_ICONS="ceammc ${ALL_ICONS}"
echo "const char* icon_ceammc = \"$(cat ceammc64.png | base64)\";"

cat <<EOF

const char* icon_default_18 = icon_help_18;
const char* icon_default_24 = icon_help_24;
const char* icon_default_36 = icon_help_36;
const char* icon_default_48 = icon_help_48;

struct icon_entry {
    t_symbol* name;
    const char* data[4];
};

EOF

echo "icon_entry icons_list[] = {"

for i in $ICONS;
do
    echo "  { &s_, { icon_${i}_18, icon_${i}_24, icon_${i}_36, icon_${i}_48 } },"
done

echo "  { &s_, { icon_default_18, icon_default_24, icon_default_36, icon_default_48 } },"
echo "  { &s_, { icon_ceammc, icon_ceammc, icon_ceammc, icon_ceammc } },"
echo "  { 0, { 0, 0, 0, 0 } }"
echo "};"

echo "void init_icon_list() {"
idx=0
for i in $ICONS;
do
    echo "  icons_list[${idx}].name = gensym(\"${i}\");"
    idx=$(($idx+1))
done
echo "  icons_list[${idx}].name = gensym(\"default\");"
idx=$(($idx+1))
echo "  icons_list[${idx}].name = gensym(\"ceammc\");"
echo "}"
echo

echo "const char* icons_string = \"${ALL_ICONS}\";";

cat <<EOF
#endif // GENERATED_ICONS_H
EOF



